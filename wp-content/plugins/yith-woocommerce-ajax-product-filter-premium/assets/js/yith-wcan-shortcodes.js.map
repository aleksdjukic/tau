{"version":3,"file":"yith-wcan-shortcodes.js","mappings":"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","sources":["webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/config.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-filter.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-filter-labels.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-reset-button.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-modal-opener.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-dropdown.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-preset.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-dropdown-premium.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-preset-premium.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/index.js"],"sourcesContent":["'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nconst $ = jQuery; // we can do this as WebPack will compact all together inside a closure.\nconst $body = $( 'body' );\n\nexport { $, $body };\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $, $body } from '../config.js';\n\nexport default class YITH_WCAN_Filter {\n\t// currently executing xhr\n\txhr = null;\n\n\t// flag set during ajax call handling\n\tdoingAjax = false;\n\n\t// register original url search param\n\toriginalSearch = location.search;\n\n\t// flag set once init has executed\n\tinitialized = false;\n\n\t// flag set when page has at least one active filter.\n\tfiltered = false;\n\n\t// init object\n\tconstructor() {\n\t\tthis.initPopState();\n\t\tthis.initialized = true;\n\t}\n\n\t// init page reload when popstate event alter filters\n\tinitPopState() {\n\t\tif ( ! yith_wcan_shortcodes.reload_on_back ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.pushUrlToHistory( window.location, document.title, null, true );\n\n\t\t$( window ).on( 'popstate', function () {\n\t\t\tif ( ! window.history.state?._yithWcan ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twindow.location.reload( true );\n\t\t} );\n\t}\n\n\t// execute call to filter products in current view\n\tdoFilter( filters, target, preset ) {\n\t\tlet targetUrl,\n\t\t\t$target = target ? $( target ) : $( 'body' ),\n\t\t\tcustomFilters;\n\n\t\t// filter properties\n\t\tcustomFilters = $( document ).triggerHandler(\n\t\t\t'yith_wcan_filters_parameters',\n\t\t\t[ filters ]\n\t\t);\n\n\t\tif ( !! customFilters ) {\n\t\t\tfilters = customFilters;\n\t\t}\n\n\t\t// block elements before filtering\n\t\t$target && this.block( $target );\n\n\t\t// calculate target url\n\t\ttargetUrl = this.buildUrl( filters );\n\n\t\t// if no ajax, simply change page url\n\t\tif ( ! yith_wcan_shortcodes.ajax_filters ) {\n\t\t\tthis.pushUrlToHistory( targetUrl, document.title, filters );\n\n\t\t\twindow.location = targetUrl;\n\t\t\treturn;\n\t\t}\n\n\t\t// start doing ajax\n\t\tthis.doingAjax = true;\n\n\t\treturn this._doAjax( targetUrl ).done( ( response ) => {\n\t\t\ttargetUrl = this.searchAlternativeUrl( response, targetUrl );\n\n\t\t\tthis._beforeFilter( response, filters );\n\n\t\t\tthis.refreshFragments( target, preset, response );\n\t\t\tthis.pushUrlToHistory( targetUrl, response.pageTitle, filters );\n\t\t\tthis.originalSearch = location.search;\n\n\t\t\t$target && this.unblock( $target );\n\n\t\t\tthis._afterFilter( response, filters );\n\n\t\t\tthis.doingAjax = false;\n\t\t} );\n\t}\n\n\t// actions performed before filter\n\t_beforeFilter( response, filters ) {\n\t\t$( document ).trigger( 'yith-wcan-ajax-loading', [\n\t\t\tresponse,\n\t\t\tfilters,\n\t\t] );\n\t}\n\n\t// actions performed after filter\n\t_afterFilter( response, filters ) {\n\t\t$( '.woocommerce-ordering' ).on(\n\t\t\t'change',\n\t\t\t'select.orderby',\n\t\t\tfunction () {\n\t\t\t\t$( this ).closest( 'form' ).submit();\n\t\t\t}\n\t\t);\n\n\t\tthis.filtered = filters && !! Object.keys( filters ).length;\n\t\tthis.filtered\n\t\t\t? $body.addClass( 'filtered' )\n\t\t\t: $body.removeClass( 'filtered' );\n\n\t\t$( window ).trigger( 'scroll' );\n\n\t\t$( document )\n\t\t\t.trigger( 'yith-wcan-ajax-filtered', [ response, filters ] )\n\t\t\t.trigger( 'yith_wcwl_reload_fragments' );\n\t}\n\n\t// build url to show\n\tbuildUrl( filters ) {\n\t\tlet queryParam = yith_wcan_shortcodes.query_param,\n\t\t\tparams = {},\n\t\t\tlocation = window.location,\n\t\t\turl = !! yith_wcan_shortcodes.base_url\n\t\t\t\t? yith_wcan_shortcodes.base_url\n\t\t\t\t: location?.origin + location?.pathname,\n\t\t\tsearch = '',\n\t\t\tself = this;\n\n\t\tconst haveFilters =\n\t\t\ttypeof filters === 'object' && Object.keys( filters ).length;\n\n\t\t// remove filter session from current url, if any\n\t\tif ( !! yith_wcan_shortcodes.session_param ) {\n\t\t\turl = url.replace(\n\t\t\t\tnew RegExp(\n\t\t\t\t\t'/' + yith_wcan_shortcodes.session_param + '/[^/]*/'\n\t\t\t\t),\n\t\t\t\t''\n\t\t\t);\n\t\t}\n\n\t\tif ( haveFilters ) {\n\t\t\tparams[ queryParam ] = 1;\n\t\t}\n\n\t\tif ( !! this.originalSearch ) {\n\t\t\tconst searchParams = this.originalSearch\n\t\t\t\t.replace( '?', '' )\n\t\t\t\t.split( '&' )\n\t\t\t\t.reduce( ( a, v ) => {\n\t\t\t\t\tconst items = v.split( '=' );\n\n\t\t\t\t\tif ( items.length === 2 ) {\n\t\t\t\t\t\tif ( this.isFilterParam( items[ 0 ] ) ) {\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ta[ items[ 0 ] ] = items[ 1 ];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn a;\n\t\t\t\t}, {} );\n\n\t\t\tparams = $.extend( params, searchParams );\n\t\t}\n\n\t\tif ( haveFilters ) {\n\t\t\tparams = $.extend( params, filters );\n\t\t}\n\n\t\tsearch = Object.keys( params )\n\t\t\t.reduce( function ( a, i ) {\n\t\t\t\tconst v = params[ i ];\n\n\t\t\t\tif ( ! v || ! i ) {\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\n\t\t\t\ta += self._cleanParam( i ) + '=' + self._cleanParam( v ) + '&';\n\n\t\t\t\treturn a;\n\t\t\t}, '?' )\n\t\t\t.replace( /&$/g, '' )\n\t\t\t.replace( /%2B/g, '+' )\n\t\t\t.replace( /%2C/g, ',' );\n\n\t\tif ( search.length > 1 ) {\n\t\t\turl += search;\n\t\t}\n\n\t\treturn url;\n\t}\n\n\t// retrieves alternative sharing url in response body\n\tsearchAlternativeUrl( response, defaultUrl = '' ) {\n\t\tlet url = defaultUrl,\n\t\t\tmatches;\n\n\t\tif ( -1 === response.indexOf( 'yith_wcan:sharing_url' ) ) {\n\t\t\treturn url;\n\t\t}\n\n\t\tmatches = response.match(\n\t\t\t/<meta name=\"yith_wcan:sharing_url\" content=\"([^\"]*)\">/\n\t\t);\n\t\turl = matches && 1 in matches ? matches[ 1 ] : url;\n\n\t\treturn url;\n\t}\n\n\t// push url to browser history\n\tpushUrlToHistory( url, title, filters, current ) {\n\t\tif (\n\t\t\t! yith_wcan_shortcodes.change_browser_url ||\n\t\t\tnavigator.userAgent.match( /msie/i )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet method = 'pushState';\n\n\t\tif ( !! current ) {\n\t\t\tmethod = 'replaceState';\n\t\t}\n\n\t\twindow.history[ method ](\n\t\t\t{\n\t\t\t\t_yithWcan: true,\n\t\t\t\tpageTitle: title,\n\t\t\t\tfilters,\n\t\t\t},\n\t\t\t'',\n\t\t\turl\n\t\t);\n\t}\n\n\t// replaces elements in the page with refreshed ones\n\trefreshFragments( target, preset, response ) {\n\t\tconst responseDom = document.createElement( 'html' ),\n\t\t\t$response = $( responseDom );\n\n\t\tresponseDom.innerHTML = response;\n\n\t\tif ( target ) {\n\t\t\tlet $preset = $( preset ),\n\t\t\t\t$target = $( target ),\n\t\t\t\t$destination;\n\n\t\t\tif ( $preset.length ) {\n\t\t\t\t$destination = $response.find( preset );\n\n\t\t\t\tif ( $destination.length ) {\n\t\t\t\t\t$preset.replaceWith( $destination.first() );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( $target.length ) {\n\t\t\t\t$destination = $response.find( target );\n\n\t\t\t\tif ( $destination.length ) {\n\t\t\t\t\t$target.replaceWith( $destination.first() );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst content = $( yith_wcan_shortcodes.content );\n\n\t\t\tif ( content.length ) {\n\t\t\t\tcontent.replaceWith(\n\t\t\t\t\t$response.find( yith_wcan_shortcodes.content )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t$( 'body' ).replaceWith( $response.find( 'body' ) );\n\t\t\t}\n\t\t}\n\n\t\t$( document ).trigger( 'yith_wcan_init_shortcodes' );\n\t}\n\n\t// clean url parameters\n\t_cleanParam( param ) {\n\t\tif (\n\t\t\t! yith_wcan_shortcodes?.process_sanitize ||\n\t\t\tyith_wcan_shortcodes?.skip_sanitize\n\t\t) {\n\t\t\treturn param;\n\t\t}\n\n\t\treturn encodeURIComponent( param );\n\t}\n\n\t// executes Ajax calls\n\t_doAjax( url, params ) {\n\t\tif ( this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\n\t\tparams = $.extend(\n\t\t\t{\n\t\t\t\turl,\n\t\t\t\theaders: {\n\t\t\t\t\t'X-YITH-WCAN': 1,\n\t\t\t\t},\n\t\t\t},\n\t\t\tparams\n\t\t);\n\n\t\tthis.xhr = $.ajax( params );\n\n\t\treturn this.xhr;\n\t}\n\n\t// block dom elements\n\tblock( $el ) {\n\t\tif ( typeof $.fn.block === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet background = '#fff center center no-repeat';\n\n\t\tif ( yith_wcan_shortcodes?.loader ) {\n\t\t\tbackground = `url('${ yith_wcan_shortcodes.loader }') ${ background }`;\n\t\t}\n\n\t\t$el.block( {\n\t\t\tmessage: null,\n\t\t\toverlayCSS: {\n\t\t\t\tbackground,\n\t\t\t\topacity: 0.7,\n\t\t\t},\n\t\t} );\n\t}\n\n\t// unblock dom elements\n\tunblock( $el ) {\n\t\tif ( typeof $.fn.unblock === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$el.unblock();\n\t}\n\n\t// checks if param is one used by layared nav to filter products.\n\tisFilterParam( param ) {\n\t\tlet supportedParams = [\n\t\t\t\t'rating_filter',\n\t\t\t\t'min_price',\n\t\t\t\t'max_price',\n\t\t\t\t'price_ranges',\n\t\t\t\t'onsale_filter',\n\t\t\t\t'instock_filter',\n\t\t\t\t'featured_filter',\n\t\t\t\t'orderby',\n\t\t\t\t'product-page',\n\t\t\t\tyith_wcan_shortcodes.query_param,\n\t\t\t],\n\t\t\tcustomParams;\n\n\t\t// filter properties\n\t\tcustomParams = $( document ).triggerHandler(\n\t\t\t'yith_wcan_supported_filters_parameters',\n\t\t\t[ supportedParams ]\n\t\t);\n\n\t\tif ( !! customParams ) {\n\t\t\tsupportedParams = customParams;\n\t\t}\n\n\t\tsupportedParams = supportedParams.concat(\n\t\t\tyith_wcan_shortcodes.supported_taxonomies.map( ( i ) =>\n\t\t\t\ti.replace( 'pa_', 'filter_' )\n\t\t\t)\n\t\t);\n\n\t\tif ( -1 !== supportedParams.indexOf( param ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( -1 !== param.indexOf( 'filter_' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( -1 !== param.indexOf( 'query_type_' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Filter_Labels {\n\t// current label set\n\t$label_set = null;\n\n\t// labels of current set\n\t$labels = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current label set\n\t\tthis.$label_set = el;\n\n\t\tthis._initLabels();\n\n\t\tthis.$label_set.data( 'filter_labels', this ).addClass( 'enhanced' );\n\t}\n\n\t// init labels\n\t_initLabels() {\n\t\tconst self = this;\n\n\t\tthis.getLabels().each( function () {\n\t\t\tconst $label = $( this );\n\n\t\t\tself._initLabel( $label );\n\t\t} );\n\t}\n\n\t// init label\n\t_initLabel( $label ) {\n\t\t$label.on( 'click', ( ev ) => {\n\t\t\tif ( this.disableLabel( $label ) ) {\n\t\t\t\tev.preventDefault();\n\t\t\t}\n\t\t} );\n\t}\n\n\t// get labels\n\tgetLabels() {\n\t\tif ( false === this.$labels ) {\n\t\t\tthis.$labels = this.$label_set.find( '.active-filter-label' );\n\t\t}\n\n\t\treturn this.$labels;\n\t}\n\n\t// disable filter\n\tdisableLabel( $label ) {\n\t\tconst properties = $label.data( 'filters' );\n\t\tlet result = false;\n\n\t\t// search for preset\n\t\t$( '.yith-wcan-filters' ).each( function () {\n\t\t\tconst preset = $( this ).data( 'preset' );\n\n\t\t\tresult =\n\t\t\t\tresult ||\n\t\t\t\tpreset.deactivateFilterByProperties( properties, true );\n\t\t} );\n\n\t\treturn result;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Reset_Button {\n\t// current button\n\t$reset = null;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current button\n\t\tthis.$reset = el;\n\n\t\tthis.$reset.on( 'click', function ( ev ) {\n\t\t\tev.preventDefault();\n\n\t\t\t$( '.yith-wcan-filters' ).each( function () {\n\t\t\t\tconst preset = $( this ).data( 'preset' );\n\n\t\t\t\tpreset.deactivateAllFilters( true );\n\t\t\t\tpreset.closeModal();\n\t\t\t} );\n\t\t} );\n\n\t\tthis.$reset.data( 'reset', this ).addClass( 'enhanced' );\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Modal_Opener {\n\t// current button\n\t$button = null;\n\n\t// YITH_WCAN_Preset object\n\tpreset = null;\n\n\t// preset dom node\n\t$preset = null;\n\n\t// is mobile flag\n\tisMobile = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current button\n\t\tthis.$button = el;\n\n\t\tthis._initPreset();\n\t\tthis._initResponsive();\n\t\tthis._initActions();\n\n\t\tthis.$button.data( 'modalOpener', this ).addClass( 'enhanced' );\n\t}\n\n\t// search for related preset\n\t_initPreset() {\n\t\tlet target = this.$button.data( 'target' ),\n\t\t\t$target;\n\n\t\tif ( target ) {\n\t\t\t$target = $( `#${ target }` );\n\t\t} else {\n\t\t\t$target = $( '.yith-wcan-filters' );\n\t\t}\n\n\t\tif ( ! $target.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$preset = $target.first();\n\t\tthis.preset = this.$preset.data( 'preset' );\n\t}\n\n\t// init responsive\n\t_initResponsive() {\n\t\tif ( ! yith_wcan_shortcodes.modal_on_mobile || ! this.preset ) {\n\t\t\tthis.$button.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst media = window.matchMedia(\n\t\t\t`(max-width: ${ yith_wcan_shortcodes.mobile_media_query }px)`\n\t\t);\n\n\t\t$( window )\n\t\t\t.on( 'resize', () => {\n\t\t\t\tconst isMobile = !! media.matches;\n\n\t\t\t\tif ( isMobile !== this.isMobile ) {\n\t\t\t\t\tthis.isMobile = isMobile;\n\t\t\t\t\tthis._afterLayoutChange();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.resize();\n\t}\n\n\t// init actions\n\t_initActions() {\n\t\tif ( ! this.$preset?.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst self = this;\n\n\t\tthis.$button.on( 'click', function ( ev ) {\n\t\t\tev.preventDefault();\n\n\t\t\tself.preset.openModal();\n\t\t} );\n\t}\n\n\t// hide/show button when needed\n\t_afterLayoutChange() {\n\t\tthis.isMobile ? this.$button.show() : this.$button.hide();\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Dropdown {\n\t// current button\n\t$originalSelect = null;\n\n\t// main element\n\t$_main = null;\n\n\t// label element\n\t$_label = null;\n\n\t// dropdown\n\t$_dropdown = null;\n\n\t// search input\n\t$_search = null;\n\n\t// show more link\n\t$_showMore = null;\n\n\t// items list\n\t$_items = null;\n\n\t// current page\n\tcurrentPage = 1;\n\n\t// options\n\toptions = {};\n\n\t// init object\n\tconstructor( el, opts ) {\n\t\tthis.$originalSelect = el;\n\n\t\tif ( ! this.$originalSelect.is( 'select' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst defaultPerPage = this.$originalSelect.data( 'per_page' ),\n\t\t\tdefaultOrder = this.$originalSelect.data( 'order' ),\n\t\t\tdefaultAll = this.$originalSelect.data( 'all-label' ),\n\t\t\tdefaults = {\n\t\t\t\tshowSearch: this.$originalSelect.data( 'show_search' ),\n\t\t\t\tpaginate: this.$originalSelect.data( 'paginate' ),\n\t\t\t\tperPage: defaultPerPage ? defaultPerPage : 10,\n\t\t\t\torder: defaultOrder ? defaultOrder : 'ASC',\n\t\t\t\tgetElements: null,\n\t\t\t\tlabels: {\n\t\t\t\t\temptyLabel: defaultAll\n\t\t\t\t\t\t? defaultAll\n\t\t\t\t\t\t: yith_wcan_shortcodes.labels?.empty_option,\n\t\t\t\t\tsearchPlaceholder:\n\t\t\t\t\t\tyith_wcan_shortcodes.labels?.search_placeholder,\n\t\t\t\t\tnoItemsFound: yith_wcan_shortcodes.labels?.no_items,\n\t\t\t\t\tshowMore: yith_wcan_shortcodes.labels?.show_more,\n\t\t\t\t},\n\t\t\t};\n\n\t\tthis.options = $.extend( defaults, opts );\n\n\t\tthis._hideSelect();\n\t\tthis._initTemplate();\n\t\tthis._initActions();\n\n\t\tthis.$originalSelect.data( 'dropdown', this ).addClass( 'enhanced' );\n\t}\n\n\t// hide select\n\t_hideSelect() {\n\t\tthis.$originalSelect.hide();\n\t}\n\n\t// create dropdown\n\t_initTemplate() {\n\t\tconst $mainSpan = $( '<div/>', {\n\t\t\t\tclass: 'yith-wcan-dropdown closed',\n\t\t\t} ),\n\t\t\t$labelSpan = $( '<div/>', {\n\t\t\t\tclass: 'dropdown-label',\n\t\t\t\thtml: this.getLabel(),\n\t\t\t} ),\n\t\t\t$dropdownSpan = $( '<div>', {\n\t\t\t\tclass: 'dropdown-wrapper',\n\t\t\t} ),\n\t\t\t$matchingItemsList = $( '<ul/>', {\n\t\t\t\tclass: 'matching-items filter-items',\n\t\t\t} );\n\n\t\t$dropdownSpan.append( $matchingItemsList );\n\t\t$mainSpan.append( $labelSpan ).append( $dropdownSpan );\n\n\t\tif ( this.options.showSearch ) {\n\t\t\tthis._initSearchTemplate( $dropdownSpan );\n\t\t}\n\n\t\tif ( this.options.paginate ) {\n\t\t\tthis._initShowMoreTemplate( $dropdownSpan );\n\t\t}\n\n\t\tthis.$originalSelect.after( $mainSpan );\n\t\tthis.$_main = $mainSpan;\n\t\tthis.$_label = $labelSpan;\n\t\tthis.$_dropdown = $dropdownSpan;\n\t\tthis.$_items = $matchingItemsList;\n\t}\n\n\t// create search field\n\t_initSearchTemplate( $dropdwonSpan ) {\n\t\tconst $container = $( '<div/>', {\n\t\t\t\tclass: 'search-field-container',\n\t\t\t} ),\n\t\t\t$search = $( '<input/>', {\n\t\t\t\tname: 's',\n\t\t\t\tclass: 'search-field',\n\t\t\t\ttype: 'search',\n\t\t\t\tplaceholder: this.options.labels.searchPlaceholder,\n\t\t\t} ).attr( 'autocomplete', 'off' );\n\n\t\t$container.append( $search ).prependTo( $dropdwonSpan );\n\t\tthis.$_search = $search;\n\t}\n\n\t// create showMore field\n\t_initShowMoreTemplate( $dropdwonSpan ) {\n\t\tconst $showMore = $( '<a/>', {\n\t\t\tclass: 'show-more',\n\t\t\ttext: this.options.labels.showMore?.replace(\n\t\t\t\t'%d',\n\t\t\t\tthis.options.perPage\n\t\t\t),\n\t\t} );\n\n\t\t$showMore.on( 'click', this.loadNextPage.bind( this ) ).hide();\n\n\t\t$dropdwonSpan.append( $showMore );\n\t\tthis.$_showMore = $showMore;\n\t}\n\n\t// init actions performed over dropdown elements\n\t_initActions() {\n\t\tconst self = this;\n\n\t\t// main open event\n\t\tthis.$_main?.on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t\tself.toggleDropdown();\n\t\t} );\n\t\tthis.$_dropdown.on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t} );\n\n\t\t// search event\n\t\tthis.$_search?.on( 'keyup search', () => {\n\t\t\tself._populateItems();\n\t\t} );\n\n\t\t// select event\n\t\tthis.$_items.on( 'change', ':input', function () {\n\t\t\tlet $li = $( this ).closest( 'li' ),\n\t\t\t\tvalue = $li.data( 'value' ),\n\t\t\t\tisActive = false;\n\n\t\t\tif (\n\t\t\t\t$li.hasClass( 'disabled' ) &&\n\t\t\t\t! self.isValueSelected( value )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$li.toggleClass( 'active' );\n\t\t\tisActive = $li.hasClass( 'active' );\n\n\t\t\tself._changeItemStatus( value, isActive );\n\t\t} );\n\t\tthis.$_items.on( 'click', 'li:not(.checkbox) a', function ( ev ) {\n\t\t\tlet $li = $( this ).closest( 'li' ),\n\t\t\t\tvalue = $li.data( 'value' ),\n\t\t\t\tisActive = false;\n\n\t\t\tev.preventDefault();\n\n\t\t\tif (\n\t\t\t\t$li.hasClass( 'disabled' ) &&\n\t\t\t\t! self.isValueSelected( value )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$li.toggleClass( 'active' );\n\t\t\tisActive = $li.hasClass( 'active' );\n\n\t\t\tif ( isActive ) {\n\t\t\t\t$li.siblings().removeClass( 'active' );\n\t\t\t}\n\n\t\t\tself._changeItemStatus( value, isActive );\n\t\t} );\n\t\tthis.$_items.on( 'click', 'label > a', function ( ev ) {\n\t\t\tconst input = $( this ).parent().find( ':input' );\n\n\t\t\tev.preventDefault();\n\n\t\t\tif (\n\t\t\t\tinput.is( '[type=\"radio\"]' ) ||\n\t\t\t\tinput.is( '[type=\"checkbox\"]' )\n\t\t\t) {\n\t\t\t\tinput.prop( 'checked', ! input.prop( 'checked' ) );\n\t\t\t}\n\n\t\t\tinput.change();\n\t\t} );\n\n\t\t// select change\n\t\tthis.$originalSelect.on( 'change', ( ev, selfOriginated ) => {\n\t\t\tif ( selfOriginated ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.$_items.find( 'li' ).each( function () {\n\t\t\t\tconst value = $( this ).data( 'value' );\n\n\t\t\t\tif ( self.isValueSelected( value ) ) {\n\t\t\t\t\tself._selectItem( value );\n\t\t\t\t} else {\n\t\t\t\t\tself._deselectItem( value );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tself.updateLabel();\n\t\t} );\n\n\t\t// close dropdown on external click; do this handler only once for any dropdown in the page\n\t\tif ( ! globalThis?.yith_wcan_dropdown_init ) {\n\t\t\t$( document ).on( 'click', this._closeAllDropdowns );\n\t\t\tglobalThis.yith_wcan_dropdown_init = true;\n\t\t}\n\t}\n\n\t// open dropdown\n\topenDropdown() {\n\t\tthis.$_main?.addClass( 'open' ).removeClass( 'closed' );\n\t\tthis._afterDropdownOpen();\n\t}\n\n\t// close dropdown\n\tcloseDropdown() {\n\t\tthis.$_main?.removeClass( 'open' ).addClass( 'closed' );\n\t}\n\n\t// close all dropdowns\n\t_closeAllDropdowns() {\n\t\tconst dropdowns = $( document )\n\t\t\t.find( 'select.enhanced' )\n\t\t\t.filter( function ( i, select ) {\n\t\t\t\tconst $el = $( select );\n\n\t\t\t\treturn !! $el.data( 'dropdown' );\n\t\t\t} );\n\n\t\tdropdowns.each( function () {\n\t\t\t$( this ).data( 'dropdown' ).closeDropdown();\n\t\t} );\n\t}\n\n\t// close other dropdowns\n\t_closeOtherDropdowns() {\n\t\tconst self = this,\n\t\t\tdropdowns = $( document )\n\t\t\t\t.find( 'select.enhanced' )\n\t\t\t\t.filter( function ( i, select ) {\n\t\t\t\t\tconst $el = $( select );\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t!! $el.data( 'dropdown' ) &&\n\t\t\t\t\t\t! $el.is( self.$originalSelect )\n\t\t\t\t\t);\n\t\t\t\t} );\n\n\t\tdropdowns.each( function () {\n\t\t\t$( this ).data( 'dropdown' ).closeDropdown();\n\t\t} );\n\t}\n\n\t// toggle dropdown\n\ttoggleDropdown() {\n\t\tthis.$_main?.toggleClass( 'open' ).toggleClass( 'closed' );\n\n\t\tif ( this.$_main?.hasClass( 'open' ) ) {\n\t\t\tthis._afterDropdownOpen();\n\t\t}\n\t}\n\n\t// perform operations after dropdown is open\n\t_afterDropdownOpen() {\n\t\tthis._closeOtherDropdowns();\n\n\t\tif ( this.$_search?.length ) {\n\t\t\tthis.$_search.val( '' );\n\t\t}\n\n\t\tthis._populateItems();\n\t}\n\n\t// get elements\n\tgetMatchingElements( search, limit ) {\n\t\tlet matchingElements = [],\n\t\t\t$options = this.getOptions(),\n\t\t\tpromise;\n\n\t\tpromise = new Promise( ( resolve ) => {\n\t\t\t// first of all, search across select option\n\t\t\t$options.each( function () {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\tvalue = t.val(),\n\t\t\t\t\tlabel = t.html(),\n\t\t\t\t\tregex = new RegExp( '.*' + search + '.*', 'i' ),\n\t\t\t\t\tshow =\n\t\t\t\t\t\t! search || regex.test( value ) || regex.test( label );\n\n\t\t\t\tif ( show ) {\n\t\t\t\t\tmatchingElements.push( {\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// then retrieve additional items\n\t\t\tif ( this.options.getElements ) {\n\t\t\t\t// we're expecting key => value pairs\n\t\t\t\tthis.options\n\t\t\t\t\t.getElements( search )\n\t\t\t\t\t.then( ( retrievedElements ) => {\n\t\t\t\t\t\tif ( retrievedElements ) {\n\t\t\t\t\t\t\t// reformat retrieved array\n\t\t\t\t\t\t\tretrievedElements = retrievedElements.reduce(\n\t\t\t\t\t\t\t\t( a, v, i ) => {\n\t\t\t\t\t\t\t\t\ta.push( { label: i, value: v } );\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// merge found results with options\n\t\t\t\t\t\t\tmatchingElements = $.extend(\n\t\t\t\t\t\t\t\tmatchingElements,\n\t\t\t\t\t\t\t\tretrievedElements\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve( this._formatItems( matchingElements, limit ) );\n\t\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tresolve( this._formatItems( matchingElements, limit ) );\n\t\t\t}\n\t\t} );\n\n\t\treturn promise;\n\t}\n\n\t// format items as key/value pairs for further processing\n\t_formatItems( items, limit ) {\n\t\tlet indexes = [],\n\t\t\thasMore = false;\n\n\t\t// remove duplicates and sort array of results\n\t\titems\n\t\t\t.filter( ( v ) => {\n\t\t\t\tif ( -1 === indexes.indexOf( v.value ) ) {\n\t\t\t\t\tindexes.push( v.value );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t} )\n\t\t\t.sort( ( a, b ) => {\n\t\t\t\tconst order = this.options.order,\n\t\t\t\t\tmod = order === 'ASC' ? 1 : -1;\n\n\t\t\t\tif ( a.value < b.value ) {\n\t\t\t\t\treturn -1 * mod;\n\t\t\t\t} else if ( a.value > b.value ) {\n\t\t\t\t\treturn mod;\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t} );\n\n\t\t// paginate when needed\n\t\tif ( limit ) {\n\t\t\thasMore = limit < Object.keys( items ).length;\n\t\t\titems = items.slice( 0, limit );\n\t\t}\n\n\t\treturn {\n\t\t\titems,\n\t\t\thasMore,\n\t\t};\n\t}\n\n\t// generate item to append to items list\n\t_generateItem( value, label ) {\n\t\tlet active = this.isValueSelected( value ),\n\t\t\toption = this.getOptionByValue( value ),\n\t\t\t$item = $( '<li/>', {\n\t\t\t\t'data-value': value,\n\t\t\t\tclass: option.length ? option.attr( 'class' ) : '',\n\t\t\t} ),\n\t\t\t$anchor;\n\n\t\tif ( option.length ) {\n\t\t\tconst template = option.data( 'template' ),\n\t\t\t\tcount = option.data( 'count' );\n\n\t\t\tlabel = template ? template : label;\n\n\t\t\tif ( !! count ) {\n\t\t\t\tlabel += count;\n\t\t\t}\n\t\t}\n\n\t\t$anchor = $( '<a/>', {\n\t\t\thref: option.length ? option.data( 'filter_url' ) : '#',\n\t\t\thtml: label,\n\t\t\trel: 'nofollow',\n\t\t\t'data-title': option.length ? option.data( 'title' ) : '',\n\t\t} );\n\n\t\tif ( this.$originalSelect.prop( 'multiple' ) ) {\n\t\t\tconst $checkbox = $( '<input/>', {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue,\n\t\t\t\t} ),\n\t\t\t\t$label = $( '<label>' );\n\n\t\t\t$checkbox.prop( 'checked', active );\n\t\t\t$label.prepend( $checkbox ).append( $anchor );\n\t\t\t$item.append( $label ).addClass( 'checkbox' );\n\t\t} else {\n\t\t\t$item.append( $anchor );\n\t\t}\n\n\t\tactive ? $item.addClass( 'active' ) : $item.removeClass( 'active' );\n\n\t\treturn $item;\n\t}\n\n\t// populate items list\n\t_populateItems( page ) {\n\t\tlet search = this.$_search?.length ? this.$_search.val() : '',\n\t\t\tperPage = this.options.paginate ? this.options.perPage : 0,\n\t\t\tlimit;\n\n\t\tpage = page ? parseInt( page ) : 1;\n\t\tlimit = page * perPage;\n\n\t\tthis.getMatchingElements( search, limit ).then( ( resultSet ) => {\n\t\t\tlet matchingItems = resultSet.items,\n\t\t\t\titems = [],\n\t\t\t\thasMore = false;\n\n\t\t\t// remove all previous items\n\t\t\tthis._emptyItems();\n\t\t\tthis._hideLoadMore();\n\n\t\t\tif ( ! matchingItems.length ) {\n\t\t\t\titems.push(\n\t\t\t\t\t$( '<li/>', { text: this.options.labels.noItemsFound } )\n\t\t\t\t);\n\n\t\t\t\tthis.currentPage = 1;\n\t\t\t} else {\n\t\t\t\tfor ( const v of matchingItems ) {\n\t\t\t\t\tif ( v.value === '' ) {\n\t\t\t\t\t\titems.unshift( this._generateItem( v.value, v.label ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\titems.push( this._generateItem( v.value, v.label ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.currentPage = page;\n\t\t\t\thasMore = resultSet.hasMore;\n\t\t\t}\n\n\t\t\tthis.$_items.append( items );\n\n\t\t\tthis.$originalSelect.trigger( 'yith_wcan_dropdown_updated' );\n\n\t\t\tif ( hasMore ) {\n\t\t\t\tthis._showLoadMore();\n\t\t\t}\n\t\t} );\n\t}\n\n\t// load next page of items\n\tloadNextPage() {\n\t\tconst page = this.currentPage + 1;\n\n\t\tthis._populateItems( page );\n\t}\n\n\t// set an item as active\n\t_selectItem( value ) {\n\t\treturn this._changeItemStatus( value, true );\n\t}\n\n\t// disable an item\n\t_deselectItem( value ) {\n\t\treturn this._changeItemStatus( value, false );\n\t}\n\n\t// change item status\n\t_changeItemStatus( value, status ) {\n\t\tconst $option = this.$originalSelect.find(\n\t\t\t`option[value=\"${ value }\"]`\n\t\t);\n\n\t\tif ( $option.length ) {\n\t\t\t$option.prop( 'selected', status );\n\n\t\t\tthis.closeDropdown();\n\t\t\tthis.updateLabel();\n\n\t\t\tthis.$originalSelect.trigger( 'change', [ true ] );\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// empty items list\n\t_emptyItems() {\n\t\tthis.$_items.html( '' );\n\t}\n\n\t// show \"Load more\" link\n\t_showLoadMore() {\n\t\tthis.$_showMore.show();\n\t}\n\n\t// hide \"Load more\" link\n\t_hideLoadMore() {\n\t\tthis.$_showMore.hide();\n\t}\n\n\t// returns select label\n\tgetLabel() {\n\t\treturn this.hasSelectedValues()\n\t\t\t? this.getSelectedLabels().join( ', ' )\n\t\t\t: this.options.labels.emptyLabel;\n\t}\n\n\t// update label to match new selection\n\tupdateLabel() {\n\t\tconst label = this.getLabel();\n\n\t\tthis.$_label?.html( label );\n\t}\n\n\t// returns select options\n\tgetOptions() {\n\t\treturn this.$originalSelect.find( 'option' );\n\t}\n\n\t// checks whether select has selected values\n\thasSelectedValues() {\n\t\treturn this.getSelectedOptions().length;\n\t}\n\n\t// checks whether a value is selected\n\tisValueSelected( value ) {\n\t\tconst found = this.getSelectedValues().indexOf( value.toString() );\n\n\t\treturn -1 !== found;\n\t}\n\n\t// retrieve selected options\n\tgetSelectedOptions() {\n\t\treturn this.$originalSelect.find( 'option' ).filter( ':selected' );\n\t}\n\n\t// retrieves an option node by value\n\tgetOptionByValue( value ) {\n\t\treturn this.$originalSelect.find( `option[value=\"${ value }\"]` );\n\t}\n\n\t// retrieve labels for selected options\n\tgetSelectedLabels() {\n\t\tconst labels = [];\n\n\t\tthis.getSelectedOptions().each( function () {\n\t\t\tlet $option = $( this ),\n\t\t\t\ttemplate = $option.data( 'template' );\n\n\t\t\ttemplate = template\n\t\t\t\t? template\n\t\t\t\t: $option.html().replace( /\\([0-9]*\\)/, '' );\n\n\t\t\tlabels.push( template );\n\t\t} );\n\n\t\treturn labels;\n\t}\n\n\t// retrieve values for selected options\n\tgetSelectedValues() {\n\t\tconst values = [];\n\n\t\tthis.getSelectedOptions().each( function () {\n\t\t\tvalues.push( $( this ).val() );\n\t\t} );\n\n\t\treturn values;\n\t}\n\n\tdestroy() {\n\t\t// TBD\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\nimport YITH_WCAN_Dropdown from './yith-wcan-dropdown';\n\nexport default class YITH_WCAN_Preset {\n\t// main preset node\n\tpreset = false;\n\t$preset = false;\n\n\t// target of the filter, if any\n\ttarget = false;\n\t$target = false;\n\n\t// filters node\n\t$filters = false;\n\n\t// filter button\n\t$filterButtons = false;\n\n\t// nodes created just for modal layout\n\tmodalElements = {};\n\n\t// retains current status of filters\n\tactiveFilters = false;\n\n\t// mobile flag\n\tisMobile = false;\n\n\t// slider timeout\n\tsliderTimeout = false;\n\n\t// registers when status has changed\n\toriginalFilters = null;\n\tdirty = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// main preset node\n\t\tthis.preset = '#' + el.attr( 'id' );\n\t\tthis.$preset = el;\n\n\t\t// target of the filter, if any\n\t\tthis.target = this.$preset.data( 'target' );\n\t\tthis.$target = this.target ? $( this.target ) : false;\n\n\t\tthis._regiterStatus();\n\t\tthis._initFilterButton();\n\t\tthis._initResponsive();\n\t\tthis._initFilters();\n\t\tthis._initActions();\n\n\t\tthis.$preset\n\t\t\t.data( 'preset', this )\n\t\t\t.addClass( 'enhanced' )\n\t\t\t.trigger( 'yith_wcan_preset_initialized', [ this ] );\n\t}\n\n\t// init filters\n\t_initFilters() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself._initFilter( $filter );\n\t\t} );\n\n\t\tthis.maybeShowClearAllFilters();\n\t}\n\n\t// init filter button\n\t_initFilterButton() {\n\t\tthis.$filterButtons = this.$preset.find( '.apply-filters' );\n\n\t\tif ( ! this.$filterButtons.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// manage filter button\n\t\tthis.$filterButtons\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\t\t\t\tthis.filter();\n\t\t\t} )\n\t\t\t.hide();\n\t}\n\n\t// init generic actions\n\t_initActions() {\n\t\tthis.$preset.find( 'form' ).on( 'submit', ( ev ) => {\n\t\t\tev.preventDefault();\n\t\t} );\n\t}\n\n\t// init responsive\n\t_initResponsive() {\n\t\tif ( ! yith_wcan_shortcodes.modal_on_mobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst media = window.matchMedia(\n\t\t\t`(max-width: ${ yith_wcan_shortcodes.mobile_media_query }px)`\n\t\t);\n\n\t\t$( window )\n\t\t\t.on( 'resize', () => {\n\t\t\t\tconst isMobile = !! media.matches;\n\n\t\t\t\tif ( isMobile !== this.isMobile ) {\n\t\t\t\t\tthis.isMobile = isMobile;\n\t\t\t\t\tthis._afterLayoutChange();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.resize();\n\t}\n\n\t// init filter\n\t_initFilter( $filter ) {\n\t\tconst self = this,\n\t\t\thandleChange = function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$currentFilter = t.closest( '.yith-wcan-filter' ),\n\t\t\t\t\tmultiple = $currentFilter.length\n\t\t\t\t\t\t? 'yes' === $currentFilter.data( 'multiple' )\n\t\t\t\t\t\t: false,\n\t\t\t\t\t$item = t.closest( '.filter-item' ),\n\t\t\t\t\t$items = $item.length\n\t\t\t\t\t\t? $currentFilter.find( '.filter-item' ).not( $item )\n\t\t\t\t\t\t: [];\n\n\t\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tev.preventDefault();\n\n\t\t\t\t$items.length &&\n\t\t\t\t\t! multiple &&\n\t\t\t\t\t$items\n\t\t\t\t\t\t.removeClass( 'active' )\n\t\t\t\t\t\t.children( 'label' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.parent( '.checked' )\n\t\t\t\t\t\t.removeClass( 'checked' );\n\t\t\t\t$item.length && $item.toggleClass( 'active' );\n\n\t\t\t\t// reset active filters.\n\t\t\t\tself.activeFilters = false;\n\n\t\t\t\tself.maybeFilter( $filter );\n\t\t\t\tself.maybeToggleClearAllFilters();\n\t\t\t\tself.maybeToggleClearFilter( $currentFilter );\n\t\t\t};\n\n\t\t// handle filter activation/deactivation by click on label (no input involved)\n\t\t$filter\n\t\t\t.find( '.filter-item' )\n\t\t\t.not( '.checkbox' )\n\t\t\t.not( '.radio' )\n\t\t\t.on( 'click', 'a', function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\t\tif ( ! $( ev?.delegateTarget ).is( $item ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\thandleChange.call( this, ev );\n\t\t\t} );\n\n\t\t// handle filter activation/deactivation from input change\n\t\t$filter.find( ':input' ).on( 'change', function ( ev ) {\n\t\t\tconst t = $( this ),\n\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\tt.prop( 'checked', false );\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\thandleChange.call( this, ev );\n\t\t} );\n\n\t\t// handle filter activation/deactivation by click on label (there is an input whose state can be switched)\n\t\t$filter.find( 'label > a' ).on( 'click', function ( ev ) {\n\t\t\tconst t = $( this ),\n\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\tev.preventDefault();\n\n\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst $input = t.parent().find( ':input' );\n\n\t\t\tif (\n\t\t\t\t$input.is( '[type=\"radio\"]' ) ||\n\t\t\t\t$input.is( '[type=\"checkbox\"]' )\n\t\t\t) {\n\t\t\t\t$input.prop( 'checked', ! $input.prop( 'checked' ) );\n\t\t\t}\n\n\t\t\t$input.change();\n\t\t} );\n\n\t\t// init tooltip\n\t\tthis._initTooltip( $filter );\n\n\t\t// init price slider\n\t\tthis._initPriceSlider( $filter );\n\n\t\t// init dropdown\n\t\tthis._initDropdown( $filter );\n\n\t\t// init collapsable\n\t\tthis._initCollapsable( $filter );\n\n\t\t// init clear anchors\n\t\tthis.maybeShowClearFilter( $filter );\n\n\t\t// init custom inputs\n\t\tif ( this.$preset?.hasClass( 'custom-style' ) ) {\n\t\t\tthis._initCustomInput( $filter );\n\t\t\t$filter.on( 'yith_wcan_dropdown_updated', function () {\n\t\t\t\tconst $dropdown = $( this ),\n\t\t\t\t\t$current = $dropdown.closest( '.yith-wcan-filter' );\n\n\t\t\t\tself._initCustomInput( $current );\n\t\t\t} );\n\t\t}\n\t}\n\n\t// init tooltip\n\t_initTooltip( $filter, position ) {\n\t\t$filter.find( '[data-title]' ).each( function () {\n\t\t\tconst t = $( this );\n\n\t\t\tif ( t.hasClass( 'tooltip-added' ) || ! t.data( 'title' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tt.on( 'mouseenter', function () {\n\t\t\t\tlet th = $( this ),\n\t\t\t\t\ttooltip = null,\n\t\t\t\t\twrapperWidth = th.outerWidth(),\n\t\t\t\t\tleft = 0,\n\t\t\t\t\twidth = 0;\n\n\t\t\t\tif (\n\t\t\t\t\t! position ||\n\t\t\t\t\t( 'top' !== position && 'right' !== position )\n\t\t\t\t) {\n\t\t\t\t\tconst container = th.closest( '.filter-item' );\n\n\t\t\t\t\tposition =\n\t\t\t\t\t\tcontainer.hasClass( 'color' ) ||\n\t\t\t\t\t\tcontainer.hasClass( 'label' )\n\t\t\t\t\t\t\t? 'top'\n\t\t\t\t\t\t\t: 'right';\n\t\t\t\t}\n\n\t\t\t\ttooltip = $( '<span>', {\n\t\t\t\t\tclass: 'yith-wcan-tooltip',\n\t\t\t\t\thtml: th.data( 'title' ),\n\t\t\t\t} );\n\n\t\t\t\tth.append( tooltip );\n\n\t\t\t\twidth = tooltip.outerWidth() + 6;\n\t\t\t\ttooltip.outerWidth( width );\n\n\t\t\t\tif ( 'top' === position ) {\n\t\t\t\t\tleft = ( wrapperWidth - width ) / 2;\n\t\t\t\t} else {\n\t\t\t\t\tleft = wrapperWidth + 15;\n\t\t\t\t}\n\n\t\t\t\ttooltip.css( { left: left.toFixed( 0 ) + 'px' } ).fadeIn( 200 );\n\n\t\t\t\tth.addClass( 'with-tooltip' );\n\t\t\t} ).on( 'mouseleave', function () {\n\t\t\t\tconst th = $( this );\n\n\t\t\t\tth.find( '.yith-wcan-tooltip' ).fadeOut( 200, function () {\n\t\t\t\t\tth.removeClass( 'with-tooltip' )\n\t\t\t\t\t\t.find( '.yith-wcan-tooltip' )\n\t\t\t\t\t\t.remove();\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\tt.addClass( 'tooltip-added' );\n\t\t} );\n\t}\n\n\t// init dropdown\n\t_initDropdown( $filter ) {\n\t\tconst $dropdown = $filter.find( 'select.filter-dropdown' );\n\n\t\tif ( ! $dropdown.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t$dropdown.hasClass( 'select2-hidden-accessible' ) &&\n\t\t\t'undefined' !== typeof $.fn.selectWoo\n\t\t) {\n\t\t\t$dropdown.selectWoo( 'destroy' );\n\t\t}\n\n\t\tthis._initDropdownObject( $dropdown, {\n\t\t\tpaginate: true,\n\t\t\tperPage: yith_wcan_shortcodes.terms_per_page,\n\t\t} );\n\t}\n\n\t// init dropdown object\n\t_initDropdownObject( $dropdown, opts ) {\n\t\treturn new YITH_WCAN_Dropdown( $dropdown, opts );\n\t}\n\n\t// init price slider\n\t_initPriceSlider( $filter ) {\n\t\tif ( ! $filter.hasClass( 'filter-price-slider' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst self = this,\n\t\t\t$container = $filter.find( '.price-slider' ),\n\t\t\t$minInput = $container.find( '.price-slider-min' ),\n\t\t\t$maxInput = $container.find( '.price-slider-max' ),\n\t\t\tmin = parseFloat( $container.data( 'min' ) ),\n\t\t\tmax = parseFloat( $container.data( 'max' ) ),\n\t\t\tcurrentMin = parseFloat( $minInput.val() ),\n\t\t\tcurrentMax = parseFloat( $maxInput.val() ),\n\t\t\tstep = parseFloat( $container.data( 'step' ) ),\n\t\t\thandleSliderChange = function () {\n\t\t\t\tif ( self.sliderTimeout ) {\n\t\t\t\t\tclearTimeout( self.sliderTimeout );\n\t\t\t\t}\n\n\t\t\t\tself.sliderTimeout = setTimeout( () => {\n\t\t\t\t\tself.maybeFilter( $filter );\n\t\t\t\t}, 300 );\n\t\t\t};\n\n\t\t$filter.find( '.price-slider-ui' ).ionRangeSlider( {\n\t\t\tskin: 'round',\n\t\t\ttype: 'double',\n\t\t\tmin,\n\t\t\tmax,\n\t\t\tstep,\n\t\t\tfrom: currentMin,\n\t\t\tto: currentMax,\n\t\t\tmin_interval: step,\n\t\t\tvalues_separator: ' - ',\n\t\t\tprettify: ( v ) => this.formatPrice( v ),\n\t\t\tonChange: ( data ) => {\n\t\t\t\t$minInput.val( data.from );\n\t\t\t\t$maxInput.val( data.to );\n\t\t\t},\n\t\t\tonFinish: handleSliderChange,\n\t\t} );\n\n\t\t$minInput\n\t\t\t.add( $maxInput )\n\t\t\t.off( 'change' )\n\t\t\t.on( 'change', handleSliderChange )\n\t\t\t.on( 'keyup', ( ev ) => {\n\t\t\t\tif ( ! ev.key.match( /[0-9,.]/ ) ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( ! $minInput.val() || ! $maxInput.val() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleSliderChange();\n\t\t\t} );\n\t}\n\n\t// init collapsable\n\t_initCollapsable( $filter ) {\n\t\tthis._initTitleCollapsable( $filter );\n\t\tthis._initHierarchyCollapsable( $filter );\n\t}\n\n\t// init toggle on click of the title\n\t_initTitleCollapsable( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._initToggle( $title, $title, $filter.find( '.filter-content' ) );\n\t}\n\n\t// init toggle on click of the parent li\n\t_initHierarchyCollapsable( $filter ) {\n\t\tconst $items = $filter.find( '.hierarchy-collapsable' );\n\n\t\tif ( ! $items.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// set parents of currently active term as open\n\t\tconst self = this,\n\t\t\tactive = $filter.find( '.active' );\n\n\t\tif ( active.length ) {\n\t\t\tactive\n\t\t\t\t.parents( '.hierarchy-collapsable' )\n\t\t\t\t.removeClass( 'closed' )\n\t\t\t\t.addClass( 'opened' );\n\n\t\t\tif (\n\t\t\t\tactive.hasClass( 'hierarchy-collapsable' ) &&\n\t\t\t\tyith_wcan_shortcodes.show_current_children\n\t\t\t) {\n\t\t\t\tactive.removeClass( 'closed' ).addClass( 'opened' );\n\t\t\t}\n\t\t}\n\n\t\t$items.each( function () {\n\t\t\tconst $t = $( this ),\n\t\t\t\t$toggle = $( '<span/>', {\n\t\t\t\t\tclass: 'toggle-handle',\n\t\t\t\t} );\n\n\t\t\t$toggle.appendTo( $t );\n\n\t\t\tself._initToggle( $toggle, $t, $t.children( 'ul.filter-items' ) );\n\t\t} );\n\t}\n\n\t// init toggle to generic toggle/target pair\n\t_initToggle( $toggle, $container, $target ) {\n\t\tif ( $container.hasClass( 'closed' ) ) {\n\t\t\t$target.hide();\n\t\t}\n\n\t\t$toggle.off( 'click' ).on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t\tev.preventDefault();\n\n\t\t\tthis.toggle( $target, $container );\n\n\t\t\t$target.trigger( 'yith_wcan_after_toggle_element', [ $container ] );\n\t\t} );\n\t}\n\n\t// init custom input\n\t_initCustomInput( $filter ) {\n\t\t$filter.find( ':input' ).each( function () {\n\t\t\tlet input = $( this ),\n\t\t\t\ttype = input.attr( 'type' ),\n\t\t\t\tcontainerClass = `${ type }button`,\n\t\t\t\tcontainer;\n\n\t\t\tif ( 'checkbox' !== type && 'radio' !== type ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( input.closest( `.${ containerClass }` ).length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( input.is( ':checked' ) ) {\n\t\t\t\tcontainerClass += ' checked';\n\t\t\t}\n\n\t\t\tcontainer = $( '<span/>', {\n\t\t\t\tclass: containerClass,\n\t\t\t} );\n\n\t\t\tinput.wrap( container ).on( 'change', function () {\n\t\t\t\tconst t = $( this );\n\n\t\t\t\tt.prop( 'checked' )\n\t\t\t\t\t? t.parent().addClass( 'checked' )\n\t\t\t\t\t: t.parent().removeClass( 'checked' );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// register initial status\n\t_regiterStatus() {\n\t\tthis.originalFilters = this.getFiltersProperties();\n\t}\n\n\t// trigger handling after layout change\n\t_afterLayoutChange() {\n\t\tif ( this.isMobile ) {\n\t\t\tthis.$preset\n\t\t\t\t.addClass( 'filters-modal' )\n\t\t\t\t.attr( 'role', 'dialog' )\n\t\t\t\t.attr( 'tabindex', '-1' )\n\t\t\t\t.hide();\n\n\t\t\tthis._addCloseModalButton();\n\t\t\tthis._addApplyFiltersModalButton();\n\t\t\tthis._switchToCollapsables();\n\n\t\t\tthis.$filterButtons?.hide();\n\t\t} else {\n\t\t\tthis.$preset\n\t\t\t\t.removeClass( 'filters-modal' )\n\t\t\t\t.removeClass( 'open' )\n\t\t\t\t.removeAttr( 'role' )\n\t\t\t\t.removeAttr( 'tabindex' )\n\t\t\t\t.show();\n\n\t\t\t$( 'body' )\n\t\t\t\t.css( 'overflow', 'auto' )\n\t\t\t\t.removeClass( 'yith-wcan-preset-modal-open' );\n\n\t\t\tthis._removeCloseModalButton();\n\t\t\tthis._removeApplyFiltersModalButton();\n\t\t\tthis._switchBackCollapsables();\n\n\t\t\tthis.$filterButtons?.show();\n\t\t}\n\t}\n\n\t// add modal close button\n\t_addCloseModalButton() {\n\t\tconst $closeButton = $( '<a/>', {\n\t\t\tclass: 'close-button',\n\t\t\thtml: '&times;',\n\t\t\t'data-dismiss': 'modal',\n\t\t\t'aria-label': yith_wcan_shortcodes.labels.close,\n\t\t} );\n\n\t\t$closeButton\n\t\t\t.prependTo( this.$preset )\n\t\t\t.on( 'click', this.closeModal.bind( this ) );\n\t\tthis.modalElements.closeButton = $closeButton;\n\t}\n\n\t// remove modal close button\n\t_removeCloseModalButton() {\n\t\tthis.modalElements?.closeButton?.remove();\n\t}\n\n\t// show main filter button for the modal\n\t_addApplyFiltersModalButton() {\n\t\tconst $filterButton = $( '<button/>', {\n\t\t\tclass: 'apply-filters main-modal-button',\n\t\t\thtml: yith_wcan_shortcodes.labels.show_results,\n\t\t\t'data-dismiss': 'modal',\n\t\t} );\n\n\t\t$filterButton.appendTo( this.$preset ).on( 'click', () => {\n\t\t\tthis.filter();\n\t\t\tthis.closeModal();\n\t\t} );\n\t\tthis.modalElements.applyFiltersButton = $filterButton;\n\t}\n\n\t// hide main filter button for the modal\n\t_removeApplyFiltersModalButton() {\n\t\tthis.modalElements?.applyFiltersButton?.remove();\n\t}\n\n\t// convert all filters to collapsable\n\t_switchToCollapsables() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$title = $filter.find( '.filter-title' );\n\n\t\t\tif ( ! $title.length || $title.hasClass( 'collapsable' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$title.addClass( 'collapsable' ).data( 'disable-collapse', true );\n\n\t\t\tself._initTitleCollapsable( $filter );\n\t\t} );\n\t}\n\n\t// switch back filters to their previous collapsable state\n\t_switchBackCollapsables() {\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$title = $filter.find( '.filter-title' );\n\n\t\t\tif (\n\t\t\t\t! $title.length ||\n\t\t\t\t! $title.hasClass( 'collapsable' ) ||\n\t\t\t\t! $title.data( 'disable-collapse' )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$title\n\t\t\t\t.removeClass( 'collapsable' )\n\t\t\t\t.removeData( 'disable-collapse', true )\n\t\t\t\t.off( 'click' );\n\n\t\t\t$filter.find( '.filter-content' ).show();\n\t\t} );\n\t}\n\n\t// close all collpasable before showing modal\n\t_openAllCollapsables() {\n\t\tthis.$filters\n\t\t\t.not( '.no-title' )\n\t\t\t.not( ( i, v ) => {\n\t\t\t\treturn this.isFilterActive( $( v ) );\n\t\t\t} )\n\t\t\t.find( '.filter-content' )\n\t\t\t.show()\n\t\t\t.end()\n\t\t\t.find( '.filter-title' )\n\t\t\t.removeClass( 'closed' )\n\t\t\t.addClass( 'opened' );\n\t}\n\n\t// close all collpasable before showing modal\n\t_closeAllCollapsables() {\n\t\tthis.$filters\n\t\t\t.not( '.no-title' )\n\t\t\t.not( ( i, v ) => {\n\t\t\t\treturn this.isFilterActive( $( v ) );\n\t\t\t} )\n\t\t\t.find( '.filter-content' )\n\t\t\t.hide()\n\t\t\t.end()\n\t\t\t.find( '.filter-title' )\n\t\t\t.addClass( 'closed' )\n\t\t\t.removeClass( 'opened' );\n\t}\n\n\t// update status change flag, if filters have changed\n\tmaybeRegisterStatusChange() {\n\t\tconst currentFilters = this.getFiltersProperties(),\n\t\t\tcurrentStr = JSON.stringify( currentFilters ),\n\t\t\toriginalStr = JSON.stringify( this.originalFilters );\n\n\t\tthis.dirty = currentStr !== originalStr;\n\t}\n\n\t// apply filters when possible\n\tmaybeFilter( $initiator ) {\n\t\t// register status change\n\t\tthis.maybeRegisterStatusChange();\n\n\t\t// filter, or show filter button.\n\t\tif ( yith_wcan_shortcodes.instant_filters && ! this.isMobile ) {\n\t\t\tthis.filter();\n\t\t} else if (\n\t\t\t! yith_wcan_shortcodes.instant_filters &&\n\t\t\t! this.isMobile\n\t\t) {\n\t\t\tthis.dirty\n\t\t\t\t? this.$filterButtons?.show()\n\t\t\t\t: this.$filterButtons?.hide();\n\t\t} else if ( this.isMobile && this.dirty ) {\n\t\t\tthis.$preset.addClass( 'with-filter-button' );\n\t\t\tthis.modalElements.applyFiltersButton?.show();\n\t\t}\n\t}\n\n\t// main filtering method\n\tfilter() {\n\t\tconst filter = window?.product_filter;\n\n\t\tfilter\n\t\t\t?.doFilter( this.getFiltersProperties(), this.target, this.preset )\n\t\t\t?.done( () => {\n\t\t\t\tlet newPreset = $( this.preset );\n\n\t\t\t\tif ( newPreset.length && yith_wcan_shortcodes.scroll_top ) {\n\t\t\t\t\t// by default, scroll till top of first preset in the page.\n\t\t\t\t\tlet targetOffset = newPreset.offset().top;\n\n\t\t\t\t\tif ( !! yith_wcan_shortcodes.scroll_target ) {\n\t\t\t\t\t\t// when we have a specific target, use that for the offset.\n\t\t\t\t\t\tconst $scrollTarget = $(\n\t\t\t\t\t\t\tyith_wcan_shortcodes.scroll_target\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\ttargetOffset = $scrollTarget.length\n\t\t\t\t\t\t\t? $scrollTarget.offset().top\n\t\t\t\t\t\t\t: targetOffset;\n\t\t\t\t\t} else if ( this.isMobile ) {\n\t\t\t\t\t\t// otherwise, if we're on mobile, scroll to the top of the page\n\t\t\t\t\t\t// (preset could be in an unexpected location).\n\t\t\t\t\t\ttargetOffset = 100;\n\t\t\t\t\t}\n\n\t\t\t\t\t$( 'body, html' ).animate( {\n\t\t\t\t\t\tscrollTop: targetOffset - 100,\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// register new filters, clear status flag\n\t\t\t\tthis.originalFilters = this.getFiltersProperties();\n\t\t\t\tthis.dirty = false;\n\t\t\t} );\n\n\t\tif ( this.isMobile ) {\n\t\t\tthis.$preset.removeClass( 'with-filter-button' );\n\t\t\tthis.modalElements.applyFiltersButton?.hide();\n\t\t\tthis.closeModal();\n\t\t}\n\t}\n\n\t// get all filter nodes\n\tgetFilters() {\n\t\tif ( false === this.$filters ) {\n\t\t\tthis.$filters = this.$preset.find( '.yith-wcan-filter' );\n\t\t}\n\n\t\treturn this.$filters;\n\t}\n\n\t// retrieves all filters that we want to apply\n\tgetActiveFilters() {\n\t\tif ( false === this.activeFilters ) {\n\t\t\tthis.activeFilters = this.getFiltersProperties();\n\t\t}\n\n\t\treturn this.activeFilters;\n\t}\n\n\t// check whether there is any filter active\n\tisAnyFilterActive() {\n\t\treturn !! Object.keys( this.getActiveFilters() ).length;\n\t}\n\n\t// checks whether current filter is active\n\tisFilterActive( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tactive,\n\t\t\tfilteredActive;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\tcase 'review':\n\t\t\tcase 'price_range':\n\t\t\t\tconst $dropdown = $filter.find( '.filter-dropdown' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tconst val = $dropdown.val();\n\n\t\t\t\t\tactive = 'object' === typeof val ? !! val?.length : !! val;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t// if we use type other than dropdown, fallthrough\n\t\t\tcase 'stock_sale':\n\t\t\t\tactive = $filter\n\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t.filter( '.active' ).length;\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tconst step = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'step' )\n\t\t\t\t\t),\n\t\t\t\t\tmin = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'min' )\n\t\t\t\t\t),\n\t\t\t\t\tmax = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'max' )\n\t\t\t\t\t),\n\t\t\t\t\tcurrentMin = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider-min' ).val()\n\t\t\t\t\t),\n\t\t\t\t\tcurrentMax = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider-max' ).val()\n\t\t\t\t\t);\n\n\t\t\t\tactive =\n\t\t\t\t\tMath.abs( currentMin - min ) >= step ||\n\t\t\t\t\tMath.abs( currentMax - max ) >= step;\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tactive =\n\t\t\t\t\t'menu_order' !== $filter.find( '.filter-order-by' ).val();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tactive = false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfilteredActive = $filter.triggerHandler( 'yith_wcan_is_filter_active', [\n\t\t\tactive,\n\t\t\tthis,\n\t\t] );\n\t\tactive =\n\t\t\ttypeof filteredActive !== 'undefined' ? filteredActive : active;\n\n\t\treturn active;\n\t}\n\n\t// count the number of active items per filter\n\tcountActiveItems( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tcount;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\tcase 'review':\n\t\t\tcase 'price_range':\n\t\t\t\tconst $dropdown = $filter.find( '.filter-dropdown' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tconst val = $dropdown.val();\n\n\t\t\t\t\tcount = 'object' === typeof val ? val?.length : +!! val;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t// if we use type other than dropdown, fallthrough\n\t\t\tcase 'stock_sale':\n\t\t\t\tcount = $filter\n\t\t\t\t\t.find( '.filter-items' )\n\t\t\t\t\t.find( '.active' ).length;\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tif ( this.isFilterActive( $filter ) ) {\n\t\t\t\t\tcount = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\tdefault:\n\t\t\t\tcount = 0;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t// retrieves filter properties for the filter\n\tgetFilterProperties( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tmultiple = 'yes' === $filter.data( 'multiple' ),\n\t\t\t$dropdown = $filter.find( '.filter-dropdown' ),\n\t\t\tproperties = {},\n\t\t\tfilteredProperties,\n\t\t\t$active;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\t\tlet activeTerms = [],\n\t\t\t\t\ttaxonomy = $filter.data( 'taxonomy' ),\n\t\t\t\t\tisAttr = 0 === taxonomy.indexOf( 'filter' ),\n\t\t\t\t\trelation = $filter.data( 'relation' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tactiveTerms = $dropdown.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tactiveTerms.push( $dropdown.val() );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tactiveTerms = $active.get().reduce( function ( a, v ) {\n\t\t\t\t\t\tlet val;\n\n\t\t\t\t\t\tv = $( v );\n\t\t\t\t\t\tval = v.is( 'label' )\n\t\t\t\t\t\t\t? v.find( ':input' ).val()\n\t\t\t\t\t\t\t: v.data( 'term-slug' );\n\n\t\t\t\t\t\tif ( ! val ) {\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ta.push( val );\n\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t}, activeTerms );\n\t\t\t\t}\n\n\t\t\t\tif ( ! multiple ) {\n\t\t\t\t\tproperties[ taxonomy ] = activeTerms.pop();\n\t\t\t\t} else {\n\t\t\t\t\tconst glue = ! isAttr && 'and' === relation ? '+' : ',';\n\t\t\t\t\tproperties[ taxonomy ] = activeTerms.join( glue );\n\t\t\t\t}\n\n\t\t\t\tif ( isAttr ) {\n\t\t\t\t\tproperties[ taxonomy.replace( 'filter_', 'query_type_' ) ] =\n\t\t\t\t\t\trelation;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'review':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tproperties.rating_filter = $dropdown.val();\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tif ( ! multiple ) {\n\t\t\t\t\t\t$active = $active.first();\n\t\t\t\t\t\tproperties.rating_filter = $active.is( 'label' )\n\t\t\t\t\t\t\t? $active.find( ':input' ).val()\n\t\t\t\t\t\t\t: $active.data( 'rating' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.rating_filter = $active\n\t\t\t\t\t\t\t.get()\n\t\t\t\t\t\t\t.reduce( function ( a, v ) {\n\t\t\t\t\t\t\t\tlet val;\n\n\t\t\t\t\t\t\t\tv = $( v );\n\t\t\t\t\t\t\t\tval = v.is( 'label' )\n\t\t\t\t\t\t\t\t\t? v.find( ':input' ).val()\n\t\t\t\t\t\t\t\t\t: v.data( 'rating' );\n\n\t\t\t\t\t\t\t\tif ( ! val ) {\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ta.push( val );\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, [] )\n\t\t\t\t\t\t\t.join( ',' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_range':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tproperties.price_ranges = $dropdown.val().join( ',' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.min_price = $dropdown\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t.split( '-' )[ 0 ];\n\t\t\t\t\t\tproperties.max_price = $dropdown\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t.split( '-' )[ 1 ];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tproperties.price_ranges = $active\n\t\t\t\t\t\t\t.get()\n\t\t\t\t\t\t\t.reduce( ( a, v ) => {\n\t\t\t\t\t\t\t\tlet min = $( v ).data( 'range-min' ),\n\t\t\t\t\t\t\t\t\tmax = $( v ).data( 'range-max' );\n\n\t\t\t\t\t\t\t\ta += ( max ? `${ min }-${ max }` : min ) + ',';\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, '' )\n\t\t\t\t\t\t\t.replace( /^(.*),$/, '$1' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.min_price = parseFloat(\n\t\t\t\t\t\t\t$active.first().data( 'range-min' )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tproperties.max_price = parseFloat(\n\t\t\t\t\t\t\t$active.first().data( 'range-max' )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tproperties.min_price = parseFloat(\n\t\t\t\t\t$filter.find( '.price-slider-min' ).val()\n\t\t\t\t);\n\t\t\t\tproperties.max_price = parseFloat(\n\t\t\t\t\t$filter.find( '.price-slider-max' ).val()\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 'stock_sale':\n\t\t\t\tif ( $filter.find( '.filter-on-sale' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.onsale_filter = 1;\n\t\t\t\t}\n\t\t\t\tif ( $filter.find( '.filter-in-stock' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.instock_filter = 1;\n\t\t\t\t}\n\t\t\t\tif ( $filter.find( '.filter-featured' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.featured_filter = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tproperties.orderby = $filter.find( '.filter-order-by' ).val();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfilteredProperties = $filter.triggerHandler(\n\t\t\t'yith_wcan_filter_properties',\n\t\t\t[ properties, self ]\n\t\t);\n\t\tproperties =\n\t\t\ttypeof filteredProperties !== 'undefined'\n\t\t\t\t? filteredProperties\n\t\t\t\t: properties;\n\n\t\treturn properties;\n\t}\n\n\t// retrieves properties for all filters of the preset\n\tgetFiltersProperties() {\n\t\tlet properties = {};\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tif ( self.isFilterActive( $filter ) ) {\n\t\t\t\tconst filterProperties = self.getFilterProperties( $filter );\n\n\t\t\t\tproperties = self.mergeProperties(\n\t\t\t\t\tproperties,\n\t\t\t\t\tfilterProperties,\n\t\t\t\t\t$filter\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t\treturn properties;\n\t}\n\n\t// retrieve filters matching any of the properties passed\n\tgetFiltersByProperties( properties ) {\n\t\tconst self = this;\n\n\t\treturn this.getFilters().filter( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tif ( self.isFilterActive( $filter ) ) {\n\t\t\t\tlet filterProperties = self.getFilterProperties( $filter ),\n\t\t\t\t\thasProp = false;\n\n\t\t\t\tfor ( const prop in properties ) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t[ 'min_price', 'max_price', 'price_ranges' ].includes(\n\t\t\t\t\t\t\tprop\n\t\t\t\t\t\t) &&\n\t\t\t\t\t\t( filterProperties.min_price ||\n\t\t\t\t\t\t\tfilterProperties.price_ranges )\n\t\t\t\t\t) {\n\t\t\t\t\t\thasProp = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if ( filterProperties[ prop ] ) {\n\t\t\t\t\t\thasProp = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn hasProp;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t} );\n\t}\n\n\t// show clear selection anchor\n\tmaybeToggleClearFilter( $filter ) {\n\t\tif ( ! this.isFilterActive( $filter ) ) {\n\t\t\tthis.maybeHideClearFilter( $filter );\n\t\t} else {\n\t\t\tthis.maybeShowClearFilter( $filter );\n\t\t}\n\t}\n\n\t// show clear all selections anchor\n\tmaybeToggleClearAllFilters() {\n\t\tif ( ! this.isAnyFilterActive() ) {\n\t\t\tthis.maybeHideClearAllFilters();\n\t\t} else {\n\t\t\tthis.maybeShowClearAllFilters();\n\t\t}\n\t}\n\n\t// show clear selection anchor\n\tmaybeShowClearFilter( $filter ) {\n\t\tif (\n\t\t\t! this.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link if already added.\n\t\t$filter.find( '.clear-selection' ).remove();\n\n\t\t// add new clear selection link.\n\t\t$( '<a/>', {\n\t\t\tclass: 'clear-selection',\n\t\t\ttext: yith_wcan_shortcodes.labels.clear_selection,\n\t\t\trole: 'button',\n\t\t} )\n\t\t\t.prependTo( $filter.find( '.filter-content' ) )\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tthis.deactivateFilter(\n\t\t\t\t\t$filter,\n\t\t\t\t\tfalse,\n\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t);\n\t\t\t\tthis.maybeHideClearFilter( $filter );\n\n\t\t\t\tif ( yith_wcan_shortcodes.instant_filters ) {\n\t\t\t\t\tthis.closeModal();\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\t// show clearAll anchor, when on mobile layout\n\tmaybeShowClearAllFilters() {\n\t\tif ( ! this.isAnyFilterActive() || ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link if already added.\n\t\tthis.$preset.find( '.clear-selection' ).remove();\n\n\t\t// add new clear selection link.\n\t\t$( '<a/>', {\n\t\t\tclass: 'clear-selection',\n\t\t\ttext: yith_wcan_shortcodes.labels.clear_all_selections,\n\t\t\trole: 'button',\n\t\t} )\n\t\t\t.prependTo( this.$preset.find( '.filters-container' ) )\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tthis.deactivateAllFilters(\n\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t);\n\t\t\t\tthis.maybeHideClearAllFilters();\n\n\t\t\t\tif ( yith_wcan_shortcodes.instant_filters ) {\n\t\t\t\t\tthis.closeModal();\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\t// hide clear selection anchor\n\tmaybeHideClearFilter( $filter ) {\n\t\tif (\n\t\t\tthis.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link.\n\t\t$filter.find( '.clear-selection' ).remove();\n\t}\n\n\t// show clearAll anchor, when on mobile layout\n\tmaybeHideClearAllFilters() {\n\t\tif ( this.isAnyFilterActive() ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link.\n\t\tthis.$preset\n\t\t\t.find( '.filters-container' )\n\t\t\t.children( '.clear-selection' )\n\t\t\t.remove();\n\t}\n\n\t// deactivate filter\n\tdeactivateFilter( $filter, properties, doFilter ) {\n\t\tconst filterType = $filter.data( 'filter-type' ),\n\t\t\t$items = $filter.find( '.filter-item' ),\n\t\t\t$activeItems = $items.filter( '.active' ),\n\t\t\t$dropdown = $filter.find( '.filter-dropdown' );\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\t\tconst taxonomy = $filter.data( 'taxonomy' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this );\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t$option.val().toString() ===\n\t\t\t\t\t\t\t\tproperties[ taxonomy ].toString()\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'term-slug' );\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tvalue.toString() ===\n\t\t\t\t\t\t\tproperties[ taxonomy ].toString()\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'review':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this );\n\n\t\t\t\t\t\t\tif ( $option.val() === properties.rating_filter ) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'rating' );\n\n\t\t\t\t\t\tif ( value === properties.rating_filter ) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_range':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this ),\n\t\t\t\t\t\t\t\tformattedRange =\n\t\t\t\t\t\t\t\t\tproperties.min_price +\n\t\t\t\t\t\t\t\t\t( properties.max_price\n\t\t\t\t\t\t\t\t\t\t? `-${ properties.max_price }`\n\t\t\t\t\t\t\t\t\t\t: '' );\n\n\t\t\t\t\t\t\tif ( $option.val() === formattedRange ) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tformattedRange,\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'min_price' ) +\n\t\t\t\t\t\t\t  ( $anchor.data( 'max_price' )\n\t\t\t\t\t\t\t\t\t? '-' + $anchor.data( 'max_price' )\n\t\t\t\t\t\t\t\t\t: '' );\n\n\t\t\t\t\t\tif ( properties.min_price ) {\n\t\t\t\t\t\t\tformattedRange =\n\t\t\t\t\t\t\t\tproperties.min_price +\n\t\t\t\t\t\t\t\t( properties.max_price\n\t\t\t\t\t\t\t\t\t? '-' + properties.max_price\n\t\t\t\t\t\t\t\t\t: '' );\n\t\t\t\t\t\t} else if ( properties.price_ranges ) {\n\t\t\t\t\t\t\tformattedRange = properties.price_ranges;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( value === formattedRange ) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tconst $priceSlider = $filter.find( '.price-slider' );\n\n\t\t\t\t$filter\n\t\t\t\t\t.find( '.price-slider-min' )\n\t\t\t\t\t.val( $priceSlider.data( 'min' ) );\n\t\t\t\t$filter\n\t\t\t\t\t.find( '.price-slider-max' )\n\t\t\t\t\t.val( $priceSlider.data( 'max' ) )\n\t\t\t\t\t.change();\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\t$filter.find( 'select' ).val( 'menu_order' );\n\t\t\t\tbreak;\n\t\t\tcase 'stock_sale':\n\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-in-stock' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-on-sale' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-featured' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\n\t\t\t\t\t$items.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\tif ( properties?.instock_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-in-stock' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( properties?.onsale_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-on-sale' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( properties?.featured_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-featured' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t$items.removeClass( 'active' );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.activeFilters = false;\n\n\t\tif ( doFilter ) {\n\t\t\tthis.filter();\n\t\t}\n\t}\n\n\t// deactivate all filters\n\tdeactivateAllFilters( doFilter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself.deactivateFilter( $filter );\n\t\t} );\n\n\t\tthis.activeFilters = false;\n\n\t\tif ( doFilter ) {\n\t\t\tthis.filter();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// deactivate filters that matches a specific set of properties\n\tdeactivateFilterByProperties( properties, doFilter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFiltersByProperties( properties );\n\n\t\tif ( ! $filters.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t$filters.each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself.deactivateFilter( $filter, properties, doFilter );\n\t\t} );\n\n\t\treturn true;\n\t}\n\n\t// open toggle\n\ttoggle( $target, $container, status ) {\n\t\tif ( 'undefined' === typeof status ) {\n\t\t\tstatus = $container.hasClass( 'closed' );\n\t\t}\n\n\t\tconst method = status ? 'slideDown' : 'slideUp',\n\t\t\tclassToAdd = status ? 'opened' : 'closed',\n\t\t\tclassToRemove = status ? 'closed' : 'opened';\n\n\t\t$target[ method ]( 400, () => {\n\t\t\t$container.addClass( classToAdd ).removeClass( classToRemove );\n\n\t\t\t$target.trigger( 'yith_wcan_toggle_element', [\n\t\t\t\t$container,\n\t\t\t\tstatus,\n\t\t\t] );\n\t\t} );\n\t}\n\n\t// open filter if title is collapsable\n\topenFilter( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggle( $filter.find( '.filter-content' ), $title, true );\n\t}\n\n\t// open all filters in a preset\n\topenAllFilters( $filter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tself.openFilter( $( this ) );\n\t\t} );\n\t}\n\n\t// close filter if title is collapsable\n\tcloseFilter( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggle( $filter.find( '.filter-content' ), $title, false );\n\t}\n\n\t// close all filters in a preset; if a specific filter is pased as parameter, system will keep it open\n\tcloseAllFilters( $filter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tself.closeFilter( $( this ) );\n\t\t} );\n\n\t\tif ( 'undefined' !== typeof $filter ) {\n\t\t\tthis.openFilter( $filter );\n\t\t}\n\t}\n\n\t// open filters as a modal, when in mobile layout\n\topenModal() {\n\t\tif ( ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( yith_wcan_shortcodes.toggles_open_on_modal ) {\n\t\t\tthis._openAllCollapsables();\n\t\t} else {\n\t\t\tthis._closeAllCollapsables();\n\t\t}\n\n\t\t$( 'body' )\n\t\t\t.css( 'overflow', 'hidden' )\n\t\t\t.addClass( 'yith-wcan-preset-modal-open' );\n\n\t\tthis.$preset.show();\n\n\t\tsetTimeout( () => {\n\t\t\tthis.$preset.addClass( 'open' );\n\t\t}, 100 );\n\t}\n\n\t// close filters modal, when in mobile layout\n\tcloseModal() {\n\t\tif ( ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$preset.removeClass( 'open' );\n\n\t\tsetTimeout( () => {\n\t\t\tthis.$preset.hide();\n\t\t\t$( 'body' )\n\t\t\t\t.css( 'overflow', 'auto' )\n\t\t\t\t.removeClass( 'yith-wcan-preset-modal-open' );\n\t\t}, 300 );\n\t}\n\n\t// utility that formats the price according to store configuration.\n\tformatPrice( price ) {\n\t\tif ( 'undefined' !== typeof accounting ) {\n\t\t\tprice = accounting.formatMoney( price, {\n\t\t\t\tsymbol: yith_wcan_shortcodes.currency_format?.symbol,\n\t\t\t\tdecimal: yith_wcan_shortcodes.currency_format?.decimal,\n\t\t\t\tthousand: yith_wcan_shortcodes.currency_format?.thousand,\n\t\t\t\tprecision: 0,\n\t\t\t\tformat: yith_wcan_shortcodes.currency_format?.format,\n\t\t\t} );\n\t\t}\n\n\t\treturn price;\n\t}\n\n\t// utility that merges together sets of filter properties\n\tmergeProperties( set1, set2, $filter ) {\n\t\t// search for common properties\n\t\tfor ( const prop in set2 ) {\n\t\t\tif ( ! set2.hasOwnProperty( prop ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( !! set1[ prop ] ) {\n\t\t\t\tswitch ( prop ) {\n\t\t\t\t\tcase 'rating_filter':\n\t\t\t\t\tcase 'min_price':\n\t\t\t\t\tcase 'max_price':\n\t\t\t\t\tcase 'onsale_filter':\n\t\t\t\t\tcase 'instock_filter':\n\t\t\t\t\tcase 'orderby':\n\t\t\t\t\t\t// just override default value\n\t\t\t\t\t\tset1[ prop ] = set2[ prop ];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif ( 0 === prop.indexOf( 'query_type_' ) ) {\n\t\t\t\t\t\t\t// query_type param\n\t\t\t\t\t\t\tset1[ prop ] = set2[ prop ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// we're dealing with taxonomy\n\t\t\t\t\t\t\tconst isAttr = 0 === prop.indexOf( 'filter_' ),\n\t\t\t\t\t\t\t\tglue = isAttr ? ',' : '+';\n\n\t\t\t\t\t\t\tlet newValue =\n\t\t\t\t\t\t\t\tset1[ prop ].replace( ',', glue ) +\n\t\t\t\t\t\t\t\tglue +\n\t\t\t\t\t\t\t\tset2[ prop ].replace( ',', glue );\n\n\t\t\t\t\t\t\tnewValue = newValue\n\t\t\t\t\t\t\t\t.split( glue )\n\t\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t\t( value, index, arr ) =>\n\t\t\t\t\t\t\t\t\t\tarr.indexOf( value ) === index\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.join( glue );\n\n\t\t\t\t\t\t\tset1[ prop ] = newValue;\n\n\t\t\t\t\t\t\tif ( isAttr ) {\n\t\t\t\t\t\t\t\tconst queryTypeParam = prop.replace(\n\t\t\t\t\t\t\t\t\t'filter_',\n\t\t\t\t\t\t\t\t\t'query_type_'\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tset1[ queryTypeParam ] = 'and';\n\t\t\t\t\t\t\t\tset2[ queryTypeParam ] = 'and';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdelete set2[ prop ];\n\t\t\t}\n\t\t}\n\n\t\t$.extend( set1, set2 );\n\n\t\treturn set1;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\nimport YITH_WCAN_Dropdown from './yith-wcan-dropdown';\n\nexport default class YITH_WCAN_Dropdown_Premium extends YITH_WCAN_Dropdown {\n\t// preset DOM\n\t$preset = false;\n\n\t// retrieve preset containing, if any\n\tgetPreset() {\n\t\tif ( this.preset ) {\n\t\t\treturn this.preset;\n\t\t}\n\n\t\tthis.$preset = this.$originalSelect.closest( '.yith-wcan-filters' );\n\n\t\tif ( ! this.$preset.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.$preset;\n\t}\n\n\t// create dropdown\n\t_initTemplate() {\n\t\tif ( ! this.getPreset()?.hasClass( 'horizontal' ) ) {\n\t\t\tsuper._initTemplate();\n\t\t} else {\n\t\t\tconst $dropdownSpan = $( '<div>', {\n\t\t\t\t\tclass: 'dropdown-wrapper',\n\t\t\t\t} ),\n\t\t\t\t$matchingItemsList = $( '<ul/>', {\n\t\t\t\t\tclass: 'matching-items filter-items',\n\t\t\t\t} );\n\n\t\t\t$dropdownSpan.append( $matchingItemsList );\n\n\t\t\tif ( this.options.showSearch ) {\n\t\t\t\tthis._initSearchTemplate( $dropdownSpan );\n\t\t\t}\n\n\t\t\tif ( this.options.paginate ) {\n\t\t\t\tthis._initShowMoreTemplate( $dropdownSpan );\n\t\t\t}\n\n\t\t\tthis.$originalSelect.after( $dropdownSpan );\n\t\t\tthis.$_main = null;\n\t\t\tthis.$_label = null;\n\t\t\tthis.$_dropdown = $dropdownSpan;\n\t\t\tthis.$_items = $matchingItemsList;\n\n\t\t\tthis._populateItems();\n\t\t}\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\nimport YITH_WCAN_Preset from './yith-wcan-preset';\nimport YITH_WCAN_Dropdown_Premium from './yith-wcan-dropdown-premium';\n\nexport default class YITH_WCAN_Preset_Premium extends YITH_WCAN_Preset {\n\t// init object\n\tconstructor( el ) {\n\t\tsuper( el );\n\n\t\tif ( this.isHorizontal() && ! globalThis.yith_wcan_backdrop_init ) {\n\t\t\tthis._initBackdropClick();\n\t\t\tglobalThis.yith_wcan_backdrop_init = true;\n\t\t}\n\t}\n\n\t// handles click outside of toggles, to close them in horizontal mode\n\t_initBackdropClick() {\n\t\tconst isHorizontal = this.isHorizontal();\n\n\t\tif ( isHorizontal ) {\n\t\t\t$( document ).on( 'click', () => {\n\t\t\t\tif ( this.isMobile ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.maybeCloseAllHorizontalToggles();\n\t\t\t} );\n\t\t}\n\t}\n\n\t// check if preset has horizontal layout\n\tisHorizontal() {\n\t\treturn this.$preset?.hasClass( 'horizontal' );\n\t}\n\n\t// apply filters when possible\n\tmaybeFilter( $initiator ) {\n\t\tconst $filter = $initiator.closest( '.yith-wcan-filter' );\n\n\t\t// register status change\n\t\tthis.maybeRegisterStatusChange();\n\n\t\tif (\n\t\t\tthis.isHorizontal() &&\n\t\t\t! this.isMobile &&\n\t\t\tthis.isHorizontalToggle( $filter.find( '.filter-title' ) )\n\t\t) {\n\t\t\t// show count when necessary\n\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\n\t\t\t// skip filtering when started from anything but Save and Clear buttons, in horizontal mode.\n\t\t\tif (\n\t\t\t\t! $initiator.hasClass( 'apply-filters' ) &&\n\t\t\t\t! $initiator.hasClass( 'clear-selection' )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tsuper.maybeFilter();\n\t}\n\n\t// show clear selection anchor\n\tmaybeShowClearFilter( $filter ) {\n\t\tif (\n\t\t\t! this.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! this.isHorizontal() || this.isMobile ) {\n\t\t\tsuper.maybeShowClearFilter( $filter );\n\t\t} else {\n\t\t\t// remove clear selection link if already added.\n\t\t\t$filter.find( '.clear-selection' ).remove();\n\n\t\t\t// add new clear selection link.\n\t\t\tconst $clearButton = $( '<a/>', {\n\t\t\t\tclass: 'clear-selection button',\n\t\t\t\ttext: yith_wcan_shortcodes.labels.clear_selection,\n\t\t\t\trole: 'button',\n\t\t\t} );\n\n\t\t\t$clearButton\n\t\t\t\t.prependTo( $filter.find( '.filter-content-footer' ) )\n\t\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\t\tev.preventDefault();\n\n\t\t\t\t\tthis.deactivateFilter(\n\t\t\t\t\t\t$filter,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t\t);\n\t\t\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\t\t\t\t\tthis.maybeHideClearFilter( $filter );\n\t\t\t\t\tthis.maybeFilter( $clearButton );\n\n\t\t\t\t\tthis.maybeCloseHorizontalToggle(\n\t\t\t\t\t\t$filter.find( '.filter-title.collapsable' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t}\n\n\t// init filter\n\t_initFilter( $filter ) {\n\t\tsuper._initFilter( $filter );\n\t\tthis.maybeUpdateFiltersCount( $filter );\n\t}\n\n\t// init tooltip\n\t_initTooltip( $filter, position ) {\n\t\tif ( this.isHorizontal() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper._initTooltip( $filter, position );\n\t}\n\n\t// trigger handling after layout change\n\t_afterLayoutChange() {\n\t\tsuper._afterLayoutChange();\n\n\t\tif ( this.isMobile ) {\n\t\t\tthis._removeAllHorizontalTogglesFooter();\n\t\t} else {\n\t\t\tthis._addAllHorizontalTogglesFooter();\n\t\t}\n\t}\n\n\t// init dropdown object\n\t_initDropdownObject( $dropdown, opts ) {\n\t\treturn new YITH_WCAN_Dropdown_Premium( $dropdown, opts );\n\t}\n\n\t// init toggle to generic toggle/target pair\n\t_initToggle( $toggle, $container, $target ) {\n\t\tconst isHorizontal = this.isHorizontal();\n\n\t\tif ( $container.hasClass( 'closed' ) ) {\n\t\t\t$target.hide();\n\t\t}\n\n\t\tif ( isHorizontal ) {\n\t\t\tthis._addHorizontalToggleFooter( $toggle );\n\t\t}\n\n\t\t$toggle.off( 'click' ).on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\n\t\t\tif (\n\t\t\t\tisHorizontal &&\n\t\t\t\t! this.isMobile &&\n\t\t\t\t$toggle.hasClass( 'filter-title' )\n\t\t\t) {\n\t\t\t\t// first of all, close other toggles.\n\t\t\t\tthis.maybeCloseAllHorizontalToggles( $target );\n\n\t\t\t\t// now open current one.\n\t\t\t\t$target.toggle( 0, () => {\n\t\t\t\t\t$container.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tthis.toggle( $target, $container );\n\t\t\t}\n\n\t\t\t$target.trigger( 'yith_wcan_after_toggle_element', [ $container ] );\n\t\t} );\n\n\t\tif ( isHorizontal ) {\n\t\t\t$target.on( 'click', ( ev ) => {\n\t\t\t\tev.stopPropagation();\n\t\t\t} );\n\t\t}\n\t}\n\n\t// check if a specific toggle should be shown in Horizontal mode\n\tisHorizontalToggle( $toggle ) {\n\t\tif ( ! this.isHorizontal() ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn $toggle.is( '.collapsable' );\n\t}\n\n\t// close toggle for horizontal layout\n\tmaybeCloseHorizontalToggle( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif (\n\t\t\t! $content.length ||\n\t\t\t! this.isHorizontal() ||\n\t\t\tthis.isMobile ||\n\t\t\t! $toggle.hasClass( 'filter-title' ) ||\n\t\t\t! this.isHorizontalToggle( $toggle )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content.hide();\n\t\t$toggle.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t}\n\n\t// close all Horizontal toggles\n\tmaybeCloseAllHorizontalToggles( $exclude ) {\n\t\t$( '.yith-wcan-filters.enhanced' )\n\t\t\t.find( '.filter-title.collapsable' )\n\t\t\t.next( '.filter-content' )\n\t\t\t.not( $exclude )\n\t\t\t.hide()\n\t\t\t.prev( '.filter-title' )\n\t\t\t.removeClass( 'opened' )\n\t\t\t.addClass( 'closed' );\n\t}\n\n\t// add filter content footer for horizontal layout\n\t_addHorizontalToggleFooter( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif (\n\t\t\t! $content.length ||\n\t\t\t! this.isHorizontal() ||\n\t\t\tthis.isMobile ||\n\t\t\t! $toggle.hasClass( 'filter-title' ) ||\n\t\t\t! this.isHorizontalToggle( $toggle )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $currentFilter = $toggle.closest( '.yith-wcan-filter' ),\n\t\t\t$footer = $( '<div/>', {\n\t\t\t\tclass: 'filter-content-footer',\n\t\t\t} ),\n\t\t\t$applyFilterButton = $( '<a/>', {\n\t\t\t\tclass: 'apply-filters button alt',\n\t\t\t\ttext: yith_wcan_shortcodes.labels.save,\n\t\t\t} );\n\n\t\t$applyFilterButton.on( 'click', () => {\n\t\t\tthis.maybeFilter( $applyFilterButton );\n\t\t\tthis.maybeCloseAllHorizontalToggles( $toggle );\n\t\t} );\n\n\t\t$footer.append( $applyFilterButton ).appendTo( $content );\n\t}\n\n\t// add filter content footer for all horizontal toggles\n\t_addAllHorizontalTogglesFooter() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t\tif ( ! $toggle.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._addHorizontalToggleFooter( $toggle );\n\t\t} );\n\t}\n\n\t// remove filter content footer for horizontal layout\n\t_removeHorizontalToggleFooter( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif ( ! $content.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content.find( '.filter-content-footer' ).remove();\n\t}\n\n\t// add filter content footer for all horizontal toggles\n\t_removeAllHorizontalTogglesFooter() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t\tif ( ! $toggle.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._removeHorizontalToggleFooter( $toggle );\n\t\t} );\n\t}\n\n\t// show filters count\n\tmaybeUpdateFiltersCount( $filter ) {\n\t\tconst $toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t// remove current count\n\t\t$toggle.find( '.filter-count' ).remove();\n\n\t\tif (\n\t\t\t! $toggle.length ||\n\t\t\t! this.isHorizontalToggle( $toggle ) ||\n\t\t\t! this.isFilterActive( $filter )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst count = this.countActiveItems( $filter );\n\n\t\t// if there is any filter active, show count\n\t\tif ( ! count ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $counter = $( '<span/>', {\n\t\t\tclass: 'filter-count',\n\t\t\ttext: count,\n\t\t} );\n\n\t\t$toggle.append( $counter );\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport YITH_WCAN_Filter from './modules/yith-wcan-filter';\nimport YITH_WCAN_Filter_Labels from './modules/yith-wcan-filter-labels';\nimport YITH_WCAN_Reset_Button from './modules/yith-wcan-reset-button';\nimport YITH_WCAN_Modal_Opener from './modules/yith-wcan-modal-opener';\nimport YITH_WCAN_Preset from './modules/yith-wcan-preset-premium';\n\njQuery( function ( $ ) {\n\t$( document )\n\t\t.on(\n\t\t\t'yith_wcan_init_shortcodes yith_plugin_fw_gutenberg_success_do_shortcode',\n\t\t\tfunction () {\n\t\t\t\t$( '.yith-wcan-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Preset( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-active-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Filter_Labels( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-reset-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Reset_Button( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-filters-opener' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Modal_Opener( $( this ) );\n\t\t\t\t\t} );\n\t\t\t}\n\t\t)\n\t\t.trigger( 'yith_wcan_init_shortcodes' );\n\n\tglobalThis.product_filter = new YITH_WCAN_Filter();\n} );\n"],"names":["$","jQuery","$body","YITH_WCAN_Filter","location","search","initPopState","initialized","yith_wcan_shortcodes","reload_on_back","pushUrlToHistory","window","document","title","on","history","state","_yithWcan","reload","filters","target","preset","targetUrl","$target","customFilters","triggerHandler","block","buildUrl","ajax_filters","doingAjax","_doAjax","done","response","searchAlternativeUrl","_beforeFilter","refreshFragments","pageTitle","originalSearch","unblock","_afterFilter","trigger","closest","submit","filtered","Object","keys","length","addClass","removeClass","queryParam","query_param","params","url","base_url","origin","pathname","self","haveFilters","session_param","replace","RegExp","searchParams","split","reduce","a","v","items","isFilterParam","extend","i","_cleanParam","defaultUrl","matches","indexOf","match","current","change_browser_url","navigator","userAgent","method","responseDom","createElement","$response","innerHTML","$preset","$destination","find","replaceWith","first","content","param","process_sanitize","skip_sanitize","encodeURIComponent","xhr","abort","headers","ajax","$el","fn","background","loader","message","overlayCSS","opacity","supportedParams","customParams","concat","supported_taxonomies","map","YITH_WCAN_Filter_Labels","el","$label_set","_initLabels","data","getLabels","each","$label","_initLabel","ev","disableLabel","preventDefault","$labels","properties","result","deactivateFilterByProperties","YITH_WCAN_Reset_Button","$reset","deactivateAllFilters","closeModal","YITH_WCAN_Modal_Opener","$button","_initPreset","_initResponsive","_initActions","modal_on_mobile","hide","media","matchMedia","mobile_media_query","isMobile","_afterLayoutChange","resize","openModal","show","YITH_WCAN_Dropdown","opts","$originalSelect","is","defaultPerPage","defaultOrder","defaultAll","defaults","showSearch","paginate","perPage","order","getElements","labels","emptyLabel","empty_option","searchPlaceholder","search_placeholder","noItemsFound","no_items","showMore","show_more","options","_hideSelect","_initTemplate","$mainSpan","$labelSpan","html","getLabel","$dropdownSpan","$matchingItemsList","append","_initSearchTemplate","_initShowMoreTemplate","after","$_main","$_label","$_dropdown","$_items","$dropdwonSpan","$container","$search","name","type","placeholder","attr","prependTo","$_search","$showMore","text","loadNextPage","bind","$_showMore","stopPropagation","toggleDropdown","_populateItems","$li","value","isActive","hasClass","isValueSelected","toggleClass","_changeItemStatus","siblings","input","parent","prop","change","selfOriginated","_selectItem","_deselectItem","updateLabel","globalThis","yith_wcan_dropdown_init","_closeAllDropdowns","_afterDropdownOpen","dropdowns","filter","select","closeDropdown","_closeOtherDropdowns","val","limit","matchingElements","$options","getOptions","promise","Promise","resolve","t","label","regex","test","push","then","retrievedElements","_formatItems","indexes","hasMore","sort","b","mod","slice","active","option","getOptionByValue","$item","$anchor","template","count","href","rel","$checkbox","prepend","page","parseInt","getMatchingElements","resultSet","matchingItems","_emptyItems","_hideLoadMore","currentPage","unshift","_generateItem","_showLoadMore","status","$option","hasSelectedValues","getSelectedLabels","join","getSelectedOptions","found","getSelectedValues","toString","values","YITH_WCAN_Preset","_regiterStatus","_initFilterButton","_initFilters","getFilters","$filter","_initFilter","maybeShowClearAllFilters","$filterButtons","handleChange","$currentFilter","multiple","$items","not","children","activeFilters","maybeFilter","maybeToggleClearAllFilters","maybeToggleClearFilter","delegateTarget","call","$input","_initTooltip","_initPriceSlider","_initDropdown","_initCollapsable","maybeShowClearFilter","_initCustomInput","$dropdown","$current","position","th","tooltip","wrapperWidth","outerWidth","left","width","container","css","toFixed","fadeIn","fadeOut","remove","selectWoo","_initDropdownObject","terms_per_page","$minInput","$maxInput","min","parseFloat","max","currentMin","currentMax","step","handleSliderChange","sliderTimeout","clearTimeout","setTimeout","ionRangeSlider","skin","from","to","min_interval","values_separator","prettify","formatPrice","onChange","onFinish","add","off","key","_initTitleCollapsable","_initHierarchyCollapsable","$title","_initToggle","parents","show_current_children","$t","$toggle","appendTo","toggle","containerClass","wrap","originalFilters","getFiltersProperties","_addCloseModalButton","_addApplyFiltersModalButton","_switchToCollapsables","removeAttr","_removeCloseModalButton","_removeApplyFiltersModalButton","_switchBackCollapsables","$closeButton","close","modalElements","closeButton","$filterButton","show_results","applyFiltersButton","removeData","$filters","isFilterActive","end","currentFilters","currentStr","JSON","stringify","originalStr","dirty","$initiator","maybeRegisterStatusChange","instant_filters","product_filter","doFilter","newPreset","scroll_top","targetOffset","offset","top","scroll_target","$scrollTarget","animate","scrollTop","getActiveFilters","filterType","filteredActive","Math","abs","filteredProperties","$active","activeTerms","taxonomy","isAttr","relation","get","pop","glue","rating_filter","price_ranges","min_price","max_price","onsale_filter","instock_filter","featured_filter","orderby","filterProperties","getFilterProperties","mergeProperties","hasProp","includes","maybeHideClearFilter","isAnyFilterActive","maybeHideClearAllFilters","show_clear_filter","clear_selection","role","deactivateFilter","clear_all_selections","$activeItems","click","formattedRange","$priceSlider","getFiltersByProperties","classToAdd","classToRemove","openFilter","closeFilter","toggles_open_on_modal","_openAllCollapsables","_closeAllCollapsables","price","accounting","formatMoney","symbol","currency_format","decimal","thousand","precision","format","set1","set2","hasOwnProperty","newValue","index","arr","queryTypeParam","YITH_WCAN_Dropdown_Premium","getPreset","YITH_WCAN_Preset_Premium","isHorizontal","yith_wcan_backdrop_init","_initBackdropClick","maybeCloseAllHorizontalToggles","isHorizontalToggle","maybeUpdateFiltersCount","$clearButton","maybeCloseHorizontalToggle","_removeAllHorizontalTogglesFooter","_addAllHorizontalTogglesFooter","_addHorizontalToggleFooter","$content","next","$exclude","prev","$footer","$applyFilterButton","save","_removeHorizontalToggleFooter","countActiveItems","$counter"],"sourceRoot":""}